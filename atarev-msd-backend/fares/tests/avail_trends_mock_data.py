import datetime
import pandas as pd
from pandas import Timestamp
from werkzeug.datastructures import ImmutableMultiDict

from base.middlewares import User


mock_fares_data = [
    {'fares': [{'fareAmount': 98.0,
    'fareCurrency': 'EUR',
    'time': 700,
    'flightKey': 'GQ607|20230504|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 41, 117000),
    'duration': 145},
   {'fareAmount': 127.00000000000001,
    'fareCurrency': 'EUR',
    'time': 1150,
    'flightKey': 'GQ601|20230504|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 41, 117000),
    'duration': 145},
   {'fareAmount': 98.0,
    'fareCurrency': 'EUR',
    'time': 2100,
    'flightKey': 'GQ603|20230504|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 41, 117000),
    'duration': 145}],
  'carrierCode': 'GQ',
  'outboundDate': 20230504,
  'marketOrigin': 'LCA',
  'marketDestination': 'ATH'},
    {'fares': [{'fareAmount': 94.0,
    'fareCurrency': 'EUR',
    'time': 700,
    'flightKey': 'CY310|20230504|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 10, 55, 32, 639000),
    'duration': 145},
   {'fareAmount': 103.99999999999999,
    'fareCurrency': 'EUR',
    'time': 1920,
    'flightKey': 'CY312|20230504|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 10, 55, 32, 639000),
    'duration': 145}],
  'carrierCode': 'CY',
  'outboundDate': 20230504,
  'marketOrigin': 'LCA',
  'marketDestination': 'ATH'},
    {'fares': [{'fareAmount': 133.0,
    'fareCurrency': 'EUR',
    'time': 500,
    'flightKey': 'OA6901|20230504|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 41, 117000),
    'duration': 145},
   {'fareAmount': 119.0,
    'fareCurrency': 'EUR',
    'time': 2055,
    'flightKey': 'OA6909|20230504|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 41, 117000),
    'duration': 145},
   {'fareAmount': 68.0,
    'fareCurrency': 'EUR',
    'time': 735,
    'flightKey': 'OA6911|20230504|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 41, 117000),
    'duration': 145},
   {'fareAmount': 152.0,
    'fareCurrency': 'EUR',
    'time': 1835,
    'flightKey': 'OA6913|20230504|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 41, 117000),
    'duration': 145},
   {'fareAmount': 176.0,
    'fareCurrency': 'EUR',
    'time': 1015,
    'flightKey': 'OA6903|20230504|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 41, 117000),
    'duration': 145},
   {'fareAmount': 152.0,
    'fareCurrency': 'EUR',
    'time': 1545,
    'flightKey': 'OA6905|20230504|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 41, 117000),
    'duration': 145}],
  'carrierCode': 'OA',
  'outboundDate': 20230504,
  'marketOrigin': 'LCA',
  'marketDestination': 'ATH'},
    {'fares': [{'fareAmount': 68.0,
    'fareCurrency': 'EUR',
    'time': 2055,
    'flightKey': 'OA6909|20230505|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 38, 560000),
    'duration': 145},
   {'fareAmount': 152.0,
    'fareCurrency': 'EUR',
    'time': 1835,
    'flightKey': 'OA6913|20230505|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 38, 560000),
    'duration': 145},
   {'fareAmount': 68.0,
    'fareCurrency': 'EUR',
    'time': 500,
    'flightKey': 'OA6901|20230505|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 38, 560000),
    'duration': 145},
   {'fareAmount': 106.0,
    'fareCurrency': 'EUR',
    'time': 735,
    'flightKey': 'OA6911|20230505|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 38, 560000),
    'duration': 145},
   {'fareAmount': 176.0,
    'fareCurrency': 'EUR',
    'time': 1015,
    'flightKey': 'OA6903|20230505|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 38, 560000),
    'duration': 145},
   {'fareAmount': 202.99999999999997,
    'fareCurrency': 'EUR',
    'time': 1545,
    'flightKey': 'OA6905|20230505|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 38, 560000),
    'duration': 145}],
  'carrierCode': 'OA',
  'outboundDate': 20230505,
  'marketOrigin': 'LCA',
  'marketDestination': 'ATH'},
    {'fares': [{'fareAmount': 60.0,
    'fareCurrency': 'EUR',
    'time': 2100,
    'flightKey': 'GQ603|20230505|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 38, 560000),
    'duration': 145},
   {'fareAmount': 98.0,
    'fareCurrency': 'EUR',
    'time': 700,
    'flightKey': 'GQ607|20230505|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 38, 560000),
    'duration': 145},
   {'fareAmount': 108.0,
    'fareCurrency': 'EUR',
    'time': 1150,
    'flightKey': 'GQ601|20230505|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 8, 6, 38, 560000),
    'duration': 145}],
  'carrierCode': 'GQ',
  'outboundDate': 20230505,
  'marketOrigin': 'LCA',
  'marketDestination': 'ATH'},
    {'fares': [{'fareAmount': 114.0,
    'fareCurrency': 'EUR',
    'time': 700,
    'flightKey': 'CY310|20230505|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 10, 55, 32, 819000),
    'duration': 145},
   {'fareAmount': 154.0,
    'fareCurrency': 'EUR',
    'time': 1750,
    'flightKey': 'CY312|20230505|LCAATH:',
    'marketOrigin': 'LCA',
    'marketDestination': 'ATH',
    'cabinName': 'Economy',
    'scrapeTime': datetime.datetime(2023, 5, 3, 10, 55, 32, 819000),
    'duration': 145}],
  'carrierCode': 'CY',
  'outboundDate': 20230505,
  'marketOrigin': 'LCA',
  'marketDestination': 'ATH'},
]

target_figure_response = {
    'fig': {'data': [{'hoverinfo': 'text',
    'legendgroup': 'CY',
    'line': {'color': '#295CFF',
     'shape': 'spline',
     'smoothing': 1.3,
     'width': 3},
    'marker': {'size': 12},
    'mode': 'lines+markers',
    'name': 'CY',
    'text': ['Departing <br />May 04 2023\t\t\tThu 7:00<br /><br />Market<br />LCA-ATH<br /><br />Flight Number<br />CY310<br /><br />Total €<br />94<br /><br />Days To Departure<br />1',
     'Departing <br />May 05 2023\t\t\tFri 7:00<br /><br />Market<br />LCA-ATH<br /><br />Flight Number<br />CY310<br /><br />Total €<br />114<br /><br />Days To Departure<br />2'],
    'x': ['2023-05-04', '2023-05-05'],
    'y': [94.0, 114.0],
    'type': 'scatter'},
   {'hoverinfo': 'text',
    'legendgroup': 'GQ',
    'line': {'color': '#02ECE6',
     'shape': 'spline',
     'smoothing': 1.3,
     'width': 3},
    'marker': {'size': 12},
    'mode': 'lines+markers',
    'name': 'GQ',
    'text': ['Departing <br />May 04 2023\t\t\tThu 7:00<br /><br />Market<br />LCA-ATH<br /><br />Flight Number<br />GQ607<br /><br />Total €<br />98<br /><br />Days To Departure<br />1',
     'Departing <br />May 05 2023\t\t\tFri 21:00<br /><br />Market<br />LCA-ATH<br /><br />Flight Number<br />GQ603<br /><br />Total €<br />60<br /><br />Days To Departure<br />2'],
    'x': ['2023-05-04', '2023-05-05'],
    'y': [98.0, 60.0],
    'type': 'scatter'},
   {'hoverinfo': 'text',
    'legendgroup': 'OA',
    'line': {'color': '#EF4351',
     'shape': 'spline',
     'smoothing': 1.3,
     'width': 3},
    'marker': {'size': 12},
    'mode': 'lines+markers',
    'name': 'OA',
    'text': ['Departing <br />May 04 2023\t\t\tThu 7:35<br /><br />Market<br />LCA-ATH<br /><br />Flight Number<br />OA6911<br /><br />Total €<br />68<br /><br />Days To Departure<br />1',
     'Departing <br />May 05 2023\t\t\tFri 20:55<br /><br />Market<br />LCA-ATH<br /><br />Flight Number<br />OA6909<br /><br />Total €<br />68<br /><br />Days To Departure<br />2'],
    'x': ['2023-05-04', '2023-05-05'],
    'y': [68.0, 68.0],
    'type': 'scatter'}],
  'layout': {'template': {'data': {'bar': [{'error_x': {'color': '#2a3f5f'},
       'error_y': {'color': '#2a3f5f'},
       'marker': {'line': {'color': '#E5ECF6', 'width': 0.5},
        'pattern': {'fillmode': 'overlay', 'size': 10, 'solidity': 0.2}},
       'type': 'bar'}],
     'barpolar': [{'marker': {'line': {'color': '#E5ECF6', 'width': 0.5},
        'pattern': {'fillmode': 'overlay', 'size': 10, 'solidity': 0.2}},
       'type': 'barpolar'}],
     'carpet': [{'aaxis': {'endlinecolor': '#2a3f5f',
        'gridcolor': 'white',
        'linecolor': 'white',
        'minorgridcolor': 'white',
        'startlinecolor': '#2a3f5f'},
       'baxis': {'endlinecolor': '#2a3f5f',
        'gridcolor': 'white',
        'linecolor': 'white',
        'minorgridcolor': 'white',
        'startlinecolor': '#2a3f5f'},
       'type': 'carpet'}],
     'choropleth': [{'colorbar': {'outlinewidth': 0, 'ticks': ''},
       'type': 'choropleth'}],
     'contour': [{'colorbar': {'outlinewidth': 0, 'ticks': ''},
       'colorscale': [[0.0, '#0d0887'],
        [0.1111111111111111, '#46039f'],
        [0.2222222222222222, '#7201a8'],
        [0.3333333333333333, '#9c179e'],
        [0.4444444444444444, '#bd3786'],
        [0.5555555555555556, '#d8576b'],
        [0.6666666666666666, '#ed7953'],
        [0.7777777777777778, '#fb9f3a'],
        [0.8888888888888888, '#fdca26'],
        [1.0, '#f0f921']],
       'type': 'contour'}],
     'contourcarpet': [{'colorbar': {'outlinewidth': 0, 'ticks': ''},
       'type': 'contourcarpet'}],
     'heatmap': [{'colorbar': {'outlinewidth': 0, 'ticks': ''},
       'colorscale': [[0.0, '#0d0887'],
        [0.1111111111111111, '#46039f'],
        [0.2222222222222222, '#7201a8'],
        [0.3333333333333333, '#9c179e'],
        [0.4444444444444444, '#bd3786'],
        [0.5555555555555556, '#d8576b'],
        [0.6666666666666666, '#ed7953'],
        [0.7777777777777778, '#fb9f3a'],
        [0.8888888888888888, '#fdca26'],
        [1.0, '#f0f921']],
       'type': 'heatmap'}],
     'heatmapgl': [{'colorbar': {'outlinewidth': 0, 'ticks': ''},
       'colorscale': [[0.0, '#0d0887'],
        [0.1111111111111111, '#46039f'],
        [0.2222222222222222, '#7201a8'],
        [0.3333333333333333, '#9c179e'],
        [0.4444444444444444, '#bd3786'],
        [0.5555555555555556, '#d8576b'],
        [0.6666666666666666, '#ed7953'],
        [0.7777777777777778, '#fb9f3a'],
        [0.8888888888888888, '#fdca26'],
        [1.0, '#f0f921']],
       'type': 'heatmapgl'}],
     'histogram': [{'marker': {'pattern': {'fillmode': 'overlay',
         'size': 10,
         'solidity': 0.2}},
       'type': 'histogram'}],
     'histogram2d': [{'colorbar': {'outlinewidth': 0, 'ticks': ''},
       'colorscale': [[0.0, '#0d0887'],
        [0.1111111111111111, '#46039f'],
        [0.2222222222222222, '#7201a8'],
        [0.3333333333333333, '#9c179e'],
        [0.4444444444444444, '#bd3786'],
        [0.5555555555555556, '#d8576b'],
        [0.6666666666666666, '#ed7953'],
        [0.7777777777777778, '#fb9f3a'],
        [0.8888888888888888, '#fdca26'],
        [1.0, '#f0f921']],
       'type': 'histogram2d'}],
     'histogram2dcontour': [{'colorbar': {'outlinewidth': 0, 'ticks': ''},
       'colorscale': [[0.0, '#0d0887'],
        [0.1111111111111111, '#46039f'],
        [0.2222222222222222, '#7201a8'],
        [0.3333333333333333, '#9c179e'],
        [0.4444444444444444, '#bd3786'],
        [0.5555555555555556, '#d8576b'],
        [0.6666666666666666, '#ed7953'],
        [0.7777777777777778, '#fb9f3a'],
        [0.8888888888888888, '#fdca26'],
        [1.0, '#f0f921']],
       'type': 'histogram2dcontour'}],
     'mesh3d': [{'colorbar': {'outlinewidth': 0, 'ticks': ''},
       'type': 'mesh3d'}],
     'parcoords': [{'line': {'colorbar': {'outlinewidth': 0, 'ticks': ''}},
       'type': 'parcoords'}],
     'pie': [{'automargin': True, 'type': 'pie'}],
     'scatter': [{'marker': {'colorbar': {'outlinewidth': 0, 'ticks': ''}},
       'type': 'scatter'}],
     'scatter3d': [{'line': {'colorbar': {'outlinewidth': 0, 'ticks': ''}},
       'marker': {'colorbar': {'outlinewidth': 0, 'ticks': ''}},
       'type': 'scatter3d'}],
     'scattercarpet': [{'marker': {'colorbar': {'outlinewidth': 0,
         'ticks': ''}},
       'type': 'scattercarpet'}],
     'scattergeo': [{'marker': {'colorbar': {'outlinewidth': 0, 'ticks': ''}},
       'type': 'scattergeo'}],
     'scattergl': [{'marker': {'colorbar': {'outlinewidth': 0, 'ticks': ''}},
       'type': 'scattergl'}],
     'scattermapbox': [{'marker': {'colorbar': {'outlinewidth': 0,
         'ticks': ''}},
       'type': 'scattermapbox'}],
     'scatterpolar': [{'marker': {'colorbar': {'outlinewidth': 0,
         'ticks': ''}},
       'type': 'scatterpolar'}],
     'scatterpolargl': [{'marker': {'colorbar': {'outlinewidth': 0,
         'ticks': ''}},
       'type': 'scatterpolargl'}],
     'scatterternary': [{'marker': {'colorbar': {'outlinewidth': 0,
         'ticks': ''}},
       'type': 'scatterternary'}],
     'surface': [{'colorbar': {'outlinewidth': 0, 'ticks': ''},
       'colorscale': [[0.0, '#0d0887'],
        [0.1111111111111111, '#46039f'],
        [0.2222222222222222, '#7201a8'],
        [0.3333333333333333, '#9c179e'],
        [0.4444444444444444, '#bd3786'],
        [0.5555555555555556, '#d8576b'],
        [0.6666666666666666, '#ed7953'],
        [0.7777777777777778, '#fb9f3a'],
        [0.8888888888888888, '#fdca26'],
        [1.0, '#f0f921']],
       'type': 'surface'}],
     'table': [{'cells': {'fill': {'color': '#EBF0F8'},
        'line': {'color': 'white'}},
       'header': {'fill': {'color': '#C8D4E3'}, 'line': {'color': 'white'}},
       'type': 'table'}]},
    'layout': {'annotationdefaults': {'arrowcolor': '#2a3f5f',
      'arrowhead': 0,
      'arrowwidth': 1},
     'autotypenumbers': 'strict',
     'coloraxis': {'colorbar': {'outlinewidth': 0, 'ticks': ''}},
     'colorscale': {'diverging': [[0, '#8e0152'],
       [0.1, '#c51b7d'],
       [0.2, '#de77ae'],
       [0.3, '#f1b6da'],
       [0.4, '#fde0ef'],
       [0.5, '#f7f7f7'],
       [0.6, '#e6f5d0'],
       [0.7, '#b8e186'],
       [0.8, '#7fbc41'],
       [0.9, '#4d9221'],
       [1, '#276419']],
      'sequential': [[0.0, '#0d0887'],
       [0.1111111111111111, '#46039f'],
       [0.2222222222222222, '#7201a8'],
       [0.3333333333333333, '#9c179e'],
       [0.4444444444444444, '#bd3786'],
       [0.5555555555555556, '#d8576b'],
       [0.6666666666666666, '#ed7953'],
       [0.7777777777777778, '#fb9f3a'],
       [0.8888888888888888, '#fdca26'],
       [1.0, '#f0f921']],
      'sequentialminus': [[0.0, '#0d0887'],
       [0.1111111111111111, '#46039f'],
       [0.2222222222222222, '#7201a8'],
       [0.3333333333333333, '#9c179e'],
       [0.4444444444444444, '#bd3786'],
       [0.5555555555555556, '#d8576b'],
       [0.6666666666666666, '#ed7953'],
       [0.7777777777777778, '#fb9f3a'],
       [0.8888888888888888, '#fdca26'],
       [1.0, '#f0f921']]},
     'colorway': ['#636efa',
      '#EF553B',
      '#00cc96',
      '#ab63fa',
      '#FFA15A',
      '#19d3f3',
      '#FF6692',
      '#B6E880',
      '#FF97FF',
      '#FECB52'],
     'font': {'color': '#2a3f5f'},
     'geo': {'bgcolor': 'white',
      'lakecolor': 'white',
      'landcolor': '#E5ECF6',
      'showlakes': True,
      'showland': True,
      'subunitcolor': 'white'},
     'hoverlabel': {'align': 'left'},
     'hovermode': 'closest',
     'mapbox': {'style': 'light'},
     'paper_bgcolor': 'white',
     'plot_bgcolor': '#E5ECF6',
     'polar': {'angularaxis': {'gridcolor': 'white',
       'linecolor': 'white',
       'ticks': ''},
      'bgcolor': '#E5ECF6',
      'radialaxis': {'gridcolor': 'white', 'linecolor': 'white', 'ticks': ''}},
     'scene': {'xaxis': {'backgroundcolor': '#E5ECF6',
       'gridcolor': 'white',
       'gridwidth': 2,
       'linecolor': 'white',
       'showbackground': True,
       'ticks': '',
       'zerolinecolor': 'white'},
      'yaxis': {'backgroundcolor': '#E5ECF6',
       'gridcolor': 'white',
       'gridwidth': 2,
       'linecolor': 'white',
       'showbackground': True,
       'ticks': '',
       'zerolinecolor': 'white'},
      'zaxis': {'backgroundcolor': '#E5ECF6',
       'gridcolor': 'white',
       'gridwidth': 2,
       'linecolor': 'white',
       'showbackground': True,
       'ticks': '',
       'zerolinecolor': 'white'}},
     'shapedefaults': {'line': {'color': '#2a3f5f'}},
     'ternary': {'aaxis': {'gridcolor': 'white',
       'linecolor': 'white',
       'ticks': ''},
      'baxis': {'gridcolor': 'white', 'linecolor': 'white', 'ticks': ''},
      'bgcolor': '#E5ECF6',
      'caxis': {'gridcolor': 'white', 'linecolor': 'white', 'ticks': ''}},
     'title': {'x': 0.05},
     'xaxis': {'automargin': True,
      'gridcolor': 'white',
      'linecolor': 'white',
      'ticks': '',
      'title': {'standoff': 15},
      'zerolinecolor': 'white',
      'zerolinewidth': 2},
     'yaxis': {'automargin': True,
      'gridcolor': 'white',
      'linecolor': 'white',
      'ticks': '',
      'title': {'standoff': 15},
      'zerolinecolor': 'white',
      'zerolinewidth': 2}}},
   'xaxis': {'title': {'text': 'Travel Date',
     'font': {'color': 'rgb(174, 181, 191)',
      'size': 23,
      'family': 'Open Sans'}},
    'tickfont': {'size': 12, 'family': 'Open Sans'},
    'gridcolor': 'rgb(248, 235, 247)',
    'zeroline': False,
    'showgrid': False},
   'yaxis': {'title': {'text': 'Minimum Fare (€)',
     'font': {'color': 'rgb(174, 181, 191)',
      'size': 13,
      'family': 'Open Sans'}},
    'tickfont': {'size': 12, 'family': 'Open Sans'},
    'gridcolor': 'rgb(248, 235, 247)',
    'zeroline': False,
    'showgrid': False,
    'range': [0, 214.0]},
   'legend': {'font': {'color': 'rgb(174, 181, 191)',
     'size': 12,
     'family': 'Open Sans'},
    'title': {'font': {'color': 'rgb(174, 181, 191)',
      'family': 'Open Sans',
      'size': 13},
     'text': '',
     'side': 'top'},
    'borderwidth': 0,
    'orientation': 'v',
    'bgcolor': 'rgb(32, 32, 68)'},
   'margin': {'l': 0, 'r': 0, 'b': 0, 't': 30, 'pad': 4},
   'paper_bgcolor': 'rgb(32, 32, 68)',
   'plot_bgcolor': 'rgb(32, 32, 68)',
   'width': 900,
   'height': 450,
   'autosize': False}},
    'stats': {'by_weekday': {'Fri': [{'carrier': 'CY',
     'fare_count': 1.0,
     'fare_avg_diff': 0.0},
    {'carrier': 'GQ', 'fare_count': 1.0, 'fare_avg_diff': -54.0},
    {'carrier': 'OA', 'fare_count': 1.0, 'fare_avg_diff': -46.0}],
   'Thu': [{'carrier': 'CY', 'fare_count': 1.0, 'fare_avg_diff': 0.0},
    {'carrier': 'GQ', 'fare_count': 1.0, 'fare_avg_diff': 4.0},
    {'carrier': 'OA', 'fare_count': 1.0, 'fare_avg_diff': -26.0}]},
  'by_duration': {'0-4': [{'carrier': 'CY',
     'fare_count': 2.0,
     'fare_avg_diff': 0.0},
    {'carrier': 'GQ', 'fare_count': 2.0, 'fare_avg_diff': -25.0},
    {'carrier': 'OA', 'fare_count': 2.0, 'fare_avg_diff': -36.0}]}},
    'carriers': {
        'CY': '#295CFF',
        'A3': '#943BFF',
        'GQ': '#02ECE6',
        'OA': '#EF4351',
        'U8': '#FF9416',
        'All': '#ffffff'
    }
}

av_trends_stats_input_df = pd.DataFrame({
    'fareAmount': {0: 74.0, 1: 73.0, 2: 109.0, 3: 92.0, 4: 127.00000000000001, 5: 133.0, 6: 150.0, 7: 114.0, 8: 114.0, 9: 202.99999999999997, 10: 127.00000000000001, 11: 225.0}, 
    'fareCurrency': {0: 'EUR', 1: 'EUR', 2: 'EUR', 3: 'EUR', 4: 'EUR', 5: 'EUR', 6: 'EUR', 7: 'EUR', 8: 'EUR', 9: 'EUR', 10: 'EUR', 11: 'EUR'}, 
    'time': {0: 700, 1: 2100, 2: 2055, 3: 2055, 4: 2100, 5: 500, 6: 500, 7: 1400, 8: 700, 9: 735, 10: 2100, 11: 735}, 
    'flightKey': {0: 'CY310|20230524|LCAATH:', 1: 'GQ603|20230524|LCAATH:', 2: 'A3909|20230524|LCAATH:', 3: 'OA6909|20230524|LCAATH:', 4: 'GQ603|20230525|LCAATH:', 5: 'OA6901|20230525|LCAATH:', 6: 'A3901|20230525|LCAATH:', 7: 'CY312|20230525|LCAATH:', 8: 'CY310|20230526|LCAATH:', 9: 'OA6911|20230526|LCAATH:', 10: 'GQ603|20230526|LCAATH:', 11: 'A3911|20230526|LCAATH:'}, 
    'marketOrigin': {0: 'LCA', 1: 'LCA', 2: 'LCA', 3: 'LCA', 4: 'LCA', 5: 'LCA', 6: 'LCA', 7: 'LCA', 8: 'LCA', 9: 'LCA', 10: 'LCA', 11: 'LCA'}, 
    'marketDestination': {0: 'ATH', 1: 'ATH', 2: 'ATH', 3: 'ATH', 4: 'ATH', 5: 'ATH', 6: 'ATH', 7: 'ATH', 8: 'ATH', 9: 'ATH', 10: 'ATH', 11: 'ATH'}, 
    'cabinName': {0: 'Economy', 1: 'Economy', 2: 'Economy', 3: 'Economy', 4: 'Economy', 5: 'Economy', 6: 'Economy', 7: 'Economy', 8: 'Economy', 9: 'Economy', 10: 'Economy', 11: 'Economy'}, 
    'scrapeTime': {0: Timestamp('2023-05-23 17:59:46.571000'), 1: Timestamp('2023-05-24 09:48:34.131000'), 2: Timestamp('2023-05-24 09:48:34.131000'), 3: Timestamp('2023-05-24 09:48:34.131000'), 4: Timestamp('2023-05-24 08:07:17.685000'), 5: Timestamp('2023-05-24 08:07:17.685000'), 6: Timestamp('2023-05-24 08:07:17.685000'), 7: Timestamp('2023-05-24 10:05:52.344000'), 8: Timestamp('2023-05-24 10:05:43.349000'), 9: Timestamp('2023-05-24 09:49:40.357000'), 10: Timestamp('2023-05-24 09:49:40.357000'), 11: Timestamp('2023-05-24 09:49:40.357000')}, 
    'duration': {0: 145, 1: 145, 2: 145, 3: 145, 4: 145, 5: 145, 6: 145, 7: 145, 8: 145, 9: 145, 10: 145, 11: 145}, 
    'fltNum': {0: 310, 1: 603, 2: 909, 3: 6909, 4: 603, 5: 6901, 6: 901, 7: 312, 8: 310, 9: 6911, 10: 603, 11: 911}, 
    'carrierCode': {0: 'CY', 1: 'GQ', 2: 'A3', 3: 'OA', 4: 'GQ', 5: 'OA', 6: 'A3', 7: 'CY', 8: 'CY', 9: 'OA', 10: 'GQ', 11: 'A3'}, 
    'outboundDate': {0: datetime.date(2023, 5, 24), 1: datetime.date(2023, 5, 24), 2: datetime.date(2023, 5, 24), 3: datetime.date(2023, 5, 24), 4: datetime.date(2023, 5, 25), 5: datetime.date(2023, 5, 25), 6: datetime.date(2023, 5, 25), 7: datetime.date(2023, 5, 25), 8: datetime.date(2023, 5, 26), 9: datetime.date(2023, 5, 26), 10: datetime.date(2023, 5, 26), 11: datetime.date(2023, 5, 26)}, 
    'lineId': {0: 'CY', 1: 'GQ', 2: 'A3', 3: 'OA', 4: 'GQ', 5: 'OA', 6: 'A3', 7: 'CY', 8: 'CY', 9: 'OA', 10: 'GQ', 11: 'A3'}, 
    'weekday': {0: 'Wed', 1: 'Wed', 2: 'Wed', 3: 'Wed', 4: 'Thu', 5: 'Thu', 6: 'Thu', 7: 'Thu', 8: 'Fri', 9: 'Fri', 10: 'Fri', 11: 'Fri'}, 
    'formatted_date': {0: 'May 24 2023', 1: 'May 24 2023', 2: 'May 24 2023', 3: 'May 24 2023', 4: 'May 25 2023', 5: 'May 25 2023', 6: 'May 25 2023', 7: 'May 25 2023', 8: 'May 26 2023', 9: 'May 26 2023', 10: 'May 26 2023', 11: 'May 26 2023'}, 
    'dtd': {0: 1, 1: 0, 2: 0, 3: 0, 4: 1, 5: 1, 6: 1, 7: 1, 8: 2, 9: 2, 10: 2, 11: 2}
})
    

av_trends_stats_request_args = ImmutableMultiDict(
    [
        ('orig_city_airport', 'LCA'), 
        ('dest_city_airport', 'ATH'), 
        ('cabin', 'ECO'), 
        ('time_range_start', '00:00'), 
        ('time_range_end', '23:59'), 
        ('date_range_start', '2023-05-24'), 
        ('date_range_end', '2023-05-26'), 
        ('duration', '0'), 
        ('weekdays', ''), 
        ('connection', ''), 
        ('graph_carriers', 'A3,GQ,OA,U8'), 
        ('flight', '')
    ]
)

av_trends_stats_request_user = User(username='cyprus', carrier='CY')

av_trends_stats_target_response = [
    {
        'pos_gap_max': None, 
        'pos_gap_min': None, 
        'neg_gap_max': '111€', 
        'neg_gap_min': '35€', 
        'neg_gap_max_weekday': 'Fri', 
        'neg_gap_min_weekday': 'Wed', 
        'neg_gap_max_date': 'May 26 2023', 
        'neg_gap_min_date': 'May 24 2023', 
        'neg_gap_max_time': '07:35', 
        'neg_gap_min_time': '20:55', 
        'pos_avg_gap': None, 
        'neg_avg_gap': '61€', 
        'pos_count': 0, 
        'neg_count': 3, 
        'maf': '60%', 
        'carrier': {'value': 'A3', 'color': '#943BFF'}
    }, 
    {
        'pos_gap_max': '1€', 
        'pos_gap_min': '1€', 
        'pos_gap_max_weekday': 'Wed', 
        'pos_gap_min_weekday': 'Wed', 
        'pos_gap_max_date': 'May 24 2023', 
        'pos_gap_min_date': 'May 24 2023', 
        'pos_gap_max_time': '21:00', 
        'pos_gap_min_time': '21:00', 
        'neg_gap_max': '13€', 
        'neg_gap_min': '13€', 
        'neg_gap_max_weekday': 'Thu',
		'neg_gap_min_weekday': 'Thu', 
		'neg_gap_max_date': 'May 25 2023', 
		'neg_gap_min_date': 'May 25 2023', 
		'neg_gap_max_time': '21:00', 
		'neg_gap_min_time': '21:00', 
		'pos_avg_gap': '1€', 
		'neg_avg_gap': '13€',
		'pos_count': 1, 
		'neg_count': 2, 
		'maf': '8%', 
		'carrier': {'value': 'GQ', 'color': '#02ECE6'}
    }, 
    {
        'pos_gap_max': None, 
        'pos_gap_min': None, 
        'neg_gap_max': '89€', 
        'neg_gap_min': '18€', 
        'neg_gap_max_weekday': 'Fri', 
        'neg_gap_min_weekday': 'Wed', 
        'neg_gap_max_date': 'May 26 2023', 
        'neg_gap_min_date': 'May 24 2023', 
        'neg_gap_max_time': '07:35', 
        'neg_gap_min_time': '20:55', 
        'pos_avg_gap': None, 
        'neg_avg_gap': '42€', 
        'pos_count': 0, 
        'neg_count': 3, 
        'maf': '42%', 
        'carrier': {'value': 'OA', 'color': '#EF4351'}
    }
]

av_trends_stats_carrier_map = {
    'CY': '#295CFF', 'A3': '#943BFF', 'GQ': '#02ECE6', 'OA': '#EF4351', 'U8': '#FF9416'
}